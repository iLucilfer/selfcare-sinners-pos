<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <style>
    body { font-family: Arial, sans-serif; color: #111; padding: 20px; }
    .header { display:flex; justify-content:space-between; align-items:center }
    .company { text-align:right }
    table { width:100%; border-collapse: collapse; margin-top: 20px;}
    th, td { padding: 8px; border-bottom: 1px solid #ddd; text-align:left }
    .total { font-weight: bold; font-size: 1.2em; }
  </style>
</head>
<body>
  <div class="header">
    <div class="brand">
      <h2><%= company.name %></h2>
      <div><small><%= company.slogan %></small></div>
    </div>
    <div class="company">
      <img src="<%= company.logoUrl %>" alt="logo" style="max-height:60px" />
      <div><strong>Factura</strong></div>
      <div><small><%= new Date(sale.created_at).toLocaleString() %></small></div>
    </div>
  </div>

  <div style="margin-top:20px">
    <table>
      <thead>
        <tr><th>Descripcion</th><th>Cantidad</th><th>Precio</th><th>Total</th></tr>
      </thead>
      <tbody>
        <% items.forEach(function(it){ %>
          <tr>
            <td><%= it.description %> <% if (it.attributes) { %> <div style="font-size:0.85em;color:#666"><%= JSON.stringify(it.attributes) %></div> <% } %></td>
            <td><%= it.quantity %></td>
            <td><%= Number(it.unit_price).toFixed(2) %> <%= company.currency %></td>
            <td><%= Number(it.total).toFixed(2) %> <%= company.currency %></td>
          </tr>
        <% }) %>
      </tbody>
    </table>

    <div style="margin-top:20px; text-align:right">
      <div>Subtotal: <%= Number(sale.subtotal).toFixed(2) %> <%= company.currency %></div>
      <div>Tax: <%= Number(sale.tax).toFixed(2) %> <%= company.currency %></div>
      <div class="total">Total: <%= Number(sale.total).toFixed(2) %> <%= company.currency %></div>
    </div>
  </div>
</body>
</html>
